# Виды сжатия

* Временное сжатие - это сжатие от кадра к кадру, идет поиск различий между двумя кадрами. Например, видеокамера стоит на штативе и снимает памятник, на фоне которого плывут облака. От кадра к кадру картинка будет почти одинаковая, только положение облаков будет меняться. Вот эти различия между кадрами и ищутся во временном сжатии.
* Пространственное сжатие - это сжатие внутри самого кадра, идет поиск различий между элементами одного кадра. Тот же пример - камера на штативе, памятник и небо. Внутри каждого кадра есть очень похожие группы пикселей, например фрагменты неба без облаков. Эти фрагменты можно хорошо сжать.

# Ключевой кадр и GOP

Ключевой кадр (или "опорный", `I-кадр` intracoded) - это кадр, сжатый пространственным сжатием. Т.е. это самодостаточный кадр, для декодирования которого устройству не нужны другие кадры.

GOP (Group Of Pictures) - это расстояние между двумя I-кадрами. Может измеряться либо количеством промежуточных кадров, либо временем, через которое вставляются I-кадры. Например, GOP = 0.5 сек означает, что ключевой кадр идет каждые полсекунды. Стандартная частота GOP равна 0.5 - 2 сек.

Между ключевыми кадрами идут промежуточные. Промежуточный кадр кодируется временным сжатием, т.е. содержит в себе лишь информацию о том, как этот промежуточный кадр отличается от предыдущего. Следовательно, такой кадр не является самостоятельным, поэтому устройство не может расшифровать его в отрыве от других кадров.

Есть два вида промежуточных кадров - P и B. О них следует знать только то, что P занимают больше места, а B - меньше и типичная схема GOP с этими кадрами выглядит так `I B B _P B B _P B B _P B B I`. Промежуточные кадры хорошо сжимаются за счет того, что несут только отличия.

Влияние GOP на качество выражается примерно так:

* При низком битрейте качество будет лучше, если GOP длинный. Все потому, что длинный GOP означает меньше опорных кадров и больше промежуточных, которые едят мало места, а значит для опорных кадров места останется больше. При коротком GOP опорных кадров будет больше, значит на каждый опорный кадр будет меньше места, следовательно качество этих опорных кадров будет плохое. Длинный GOP потенциально может вести к багам, т.к. если возникает ошибка, то она тянется до следующего опорника. Но это касается в основном только стриминга, а не кодирования фильмов.
* При высоком битрейте короткий GOP даст наилучшее качество, потому что будет много опорных кадров, которые дают наиболее точное представление о картинке, и если на них всех хватает места, то и качество не страдает.



